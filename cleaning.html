<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pension Bettina - Training Simulator</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* 1. CORPORATE DESIGN (Berkshire Hathaway Vibe) */
    :root {
      --bg-color: #F5F5F0; 
      --text-color: #000000; 
      --link-color: #0000EE; 
      --link-hover: #551A8B; 
    }

    body, html {
      margin: 0;
      padding: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: "Times New Roman", Times, serif; 
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    body::before {
      content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image: repeating-linear-gradient(transparent, transparent 49px, #E0E0E0 49px, #E0E0E0 50px);
      z-index: -1;
    }

    /* 2. NAVBAR (Exakt wie auf der Startseite) */
    .navbar {
      z-index: 1000;
      background: #FFFFFF !important;
      border-bottom: 2px solid #000;
      padding: 10px 0;
    }
    .navbar-brand { 
      font-size: 1.5rem; font-weight: bold; color: #000 !important; 
      font-family: Arial, sans-serif; letter-spacing: 0px;
    }
    .nav-link {
      color: var(--link-color) !important;
      text-decoration: underline !important; 
      font-family: Arial, sans-serif;
      font-size: 0.9rem; margin: 0 10px;
    }
    .nav-link:hover { color: var(--link-hover) !important; }

    /* 3. SPIEL-BEREICH (Zentriert unter dem Men√º) */
    .game-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: 70px; /* Platz f√ºr die Navbar */
    }

    .game-container h1 {
      font-family: Arial, sans-serif;
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 5px;
      border-bottom: 1px solid #000;
      padding-bottom: 5px;
    }

    .game-container p {
      font-family: Arial, sans-serif;
      font-size: 1rem;
      color: #333;
      margin-bottom: 15px;
    }

    /* Das Spielfeld selbst */
    #gameCanvas {
      background-color: #FFFFFF; /* Sauberer B√ºro-Boden */
      border: 2px solid #000; /* Harter Corporate Rahmen */
      box-shadow: 4px 4px 0px #000;
    }

    .score-board {
      font-family: "Courier New", Courier, monospace;
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 15px;
      background: #000;
      color: #00FF00; /* B√∂rsen-Gr√ºn */
      padding: 5px 15px;
      border: 1px solid #000;
    }

    .controls-hint {
      margin-top: 10px;
      font-family: Arial, sans-serif;
      font-size: 0.85rem;
      color: #666;
    }

    /* Neustart-Button im System-Look */
    #restartBtn {
      display: none;
      margin-top: 15px;
      padding: 8px 16px;
      background: #E0E0E0;
      color: #000;
      border: 2px solid #000;
      font-weight: bold;
      font-family: Arial, sans-serif;
      cursor: pointer;
      box-shadow: 2px 2px 0px #000;
    }
    #restartBtn:hover {
      background: #CCCCCC;
      transform: translate(1px, 1px);
      box-shadow: 1px 1px 0px #000;
    }

    /* IFRAME-MODUS: Wenn die Seite eingebunden ist, blenden wir Navigation aus */
    .in-iframe .navbar { display: none !important; }
    .in-iframe .game-container { margin-top: 0; }
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg fixed-top" id="main-nav">
    <div class="container">
      <a class="navbar-brand" href="index.html">[PROJEKTNAME]</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Startseite</a></li>
          <li class="nav-item"><a class="nav-link" href="ueber-uns.html">√úber uns</a></li>
          <li class="nav-item"><a class="nav-link" href="veranstaltungen.html">Veranstaltungen</a></li>
          <li class="nav-item"><a class="nav-link" href="merch.html">Unterst√ºtzung</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="game-container">
    <h1>TRAINING SIMULATOR</h1>
    <p>Navigieren Sie das Ger√§t. Vermeiden Sie Kollisionen mit dem Kabelstrang.</p>

    <canvas id="gameCanvas" width="360" height="360"></canvas>

    <div class="score-board">EFFIZIENZ-RATE: <span id="scoreDisplay">0</span></div>
    <div class="controls-hint">Input: Pfeiltasten (Tastatur)</div>
    
    <button id="restartBtn" onclick="location.reload()">System Neustart</button>
  </div>


  <script>
    // 1. IFRAME ERKENNUNG
    // Pr√ºft, ob das Spiel gerade auf der Startseite im kleinen Fenster l√§uft
    if (window.self !== window.top) {
      document.body.classList.add('in-iframe');
    }

    // 2. DAS SPIEL (Logik leicht angepasst f√ºr Corporate Design)
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const box = 20; // Gr√∂√üe der Gitterfelder (360px / 20 = 18 Felder)
    const trashItems = ["üß¶", "üçï", "‚òÅÔ∏è", "üï∑Ô∏è", "üç∫"];
    let currentTrash = getRandomTrash();

    let score = 0;
    
    // Startposition
    let vacuum = [];
    vacuum[0] = { x: 9 * box, y: 9 * box };

    let food = {
      x: Math.floor(Math.random() * 17) * box,
      y: Math.floor(Math.random() * 17) * box
    };

    let d;
    let nextD; 

    // Tastatur-Steuerung aktivieren
    document.addEventListener("keydown", direction);

    // Pfeiltasten ignorieren beim Scrollen der Seite (wichtig f√ºr die Nutzbarkeit im iframe!)
    window.addEventListener("keydown", function(e) {
      if(["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
          e.preventDefault();
      }
    }, false);

    function direction(event) {
      if (event.keyCode == 37 && d != "RIGHT") nextD = "LEFT";
      else if (event.keyCode == 38 && d != "DOWN") nextD = "UP";
      else if (event.keyCode == 39 && d != "LEFT") nextD = "RIGHT";
      else if (event.keyCode == 40 && d != "UP") nextD = "DOWN";
    }

    function getRandomTrash() {
      return trashItems[Math.floor(Math.random() * trashItems.length)];
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      d = nextD;

      for (let i = 0; i < vacuum.length; i++) {
        if (i === 0) {
          // Kopf (Roter Block im Corporate Style)
          ctx.fillStyle = "#CC0000"; 
          ctx.fillRect(vacuum[i].x, vacuum[i].y, box, box);
          ctx.fillStyle = "#000000";
          ctx.strokeRect(vacuum[i].x, vacuum[i].y, box, box);
        } else {
          // Kabel (Schwarze Quadrate)
          ctx.fillStyle = "#333333"; 
          ctx.fillRect(vacuum[i].x + 2, vacuum[i].y + 2, box - 4, box - 4);
        }
      }

      ctx.font = "16px Arial";
      ctx.fillText(currentTrash, food.x + 2, food.y + 15);

      let vacuumX = vacuum[0].x;
      let vacuumY = vacuum[0].y;

      if (d == "LEFT") vacuumX -= box;
      if (d == "UP") vacuumY -= box;
      if (d == "RIGHT") vacuumX += box;
      if (d == "DOWN") vacuumY += box;

      if (vacuumX == food.x && vacuumY == food.y) {
        score++;
        document.getElementById("scoreDisplay").innerText = score;
        currentTrash = getRandomTrash();
        food = {
          x: Math.floor(Math.random() * 17) * box,
          y: Math.floor(Math.random() * 17) * box
        };
      } else {
        vacuum.pop();
      }

      let newHead = { x: vacuumX, y: vacuumY };

      // GAME OVER
      if (vacuumX < 0 || vacuumX >= canvas.width || vacuumY < 0 || vacuumY >= canvas.height || collision(newHead, vacuum)) {
        clearInterval(game);
        
        ctx.fillStyle = "rgba(255, 255, 255, 0.9)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        ctx.fillStyle = "#CC0000";
        ctx.font = "bold 24px Arial";
        ctx.textAlign = "center";
        ctx.fillText("SYSTEMFEHLER", canvas.width / 2, canvas.height / 2 - 10);
        
        ctx.fillStyle = "#000000";
        ctx.font = "14px Courier New";
        ctx.fillText("Effizienz ungen√ºgend.", canvas.width / 2, canvas.height / 2 + 15);
        
        document.getElementById("restartBtn").style.display = "block";
        return;
      }

      vacuum.unshift(newHead);
    }

    function collision(head, array) {
      for (let i = 0; i < array.length; i++) {
        if (head.x == array[i].x && head.y == array[i].y) {
          return true;
        }
      }
      return false;
    }

    let game = setInterval(draw, 120);

  </script>
</body>
</html>
